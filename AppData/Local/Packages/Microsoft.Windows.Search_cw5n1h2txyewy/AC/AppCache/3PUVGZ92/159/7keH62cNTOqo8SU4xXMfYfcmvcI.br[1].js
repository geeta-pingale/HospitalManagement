var WSB;(function(n){var t;(function(t){function c(t){f=t;r=new n.CancellationManager;n.config.msftRewardsDrop&&n.Host.bindKeyEscape(n=>{const t=_ge("rewardsBadgeButton");t&&"true"===t.getAttribute("aria-expanded")&&(n.handled=!0,i(!0))})}function e(t,f){if(u){t&&t();u=!1;s();const e=y();n.fetchUrl(e,n.Host.getCustomHeaders(null),null,n=>{if(n.status>=400){i();return}s({flyoutUrl:e,innerHtml:n.responseText,launchUri:(n,t,i)=>{a(n,f,t,i)},onBlur:()=>i(!0)})},r)}else i()}function l(){var t;return(n.revIpRegionCache===null||n.revIpRegionCache===void 0?void 0:n.revIpRegionCache.length)==2&&((t=n.getCurrentLanguage())===null||t===void 0?void 0:t.toLowerCase().endsWith(n.revIpRegionCache.toLowerCase()))}function o(){return n.config.isRewardsEnabled?!0:n.config.supportedRewardsFlyoutMarkets["*"]||n.config.supportedRewardsFlyoutMarkets[n.getCurrentLanguage().toLowerCase()]&&l()}function a(t,f,s,h){return n.config.rewFly&&o()&&t.match(/fd\/auth\/signin/)?(t=t.replace("BINGIP","CORTIP").replace("BINGTRIAL5TO250P201808","MULTIWSBACQ201910"),n.fetchUrl(t,n.Host.getCustomHeaders(null),null,n=>{if(n.status>=400){i();return}u=!0;e(null,f)},r)):(f(s,h),n.Host.launchUriAsync(v(t)))}function v(n){return`${n}${n.indexOf("?")>0?"&":"?"}${h}`}function y(){const t=n.Host.getWindowsTheme()==2?"&isDarkMode=1":"",i=`&ver=${_G.AppVer}&IID=RewardsFlyout.1000&IG=${_G.IG}`,r=`&cvid=${n.Host.getConversationId()}`;return`${"/rewardsapp/flyout?channel=0&partnerid=windowssearchbox"}${t}${i}${r}`}function s(t=null){const i=_ge("rewardsBadgeButton");i&&(i.blur(),i.setAttribute("aria-expanded","true"));t=t||{};t.loadingText=n.Host.getLocString("Loading");f.updateRewardsFlyout(t)}function i(t){r&&r.cancelAll(!1);const i=_ge("rewardsBadgeButton");i&&(n.config.msftRewardsDrop&&t?i.focus():i.blur(),i.setAttribute("aria-expanded","false"));f.updateRewardsFlyout(null);n.safeSetTimeout(()=>{u=!0},500,"hideRewardsFlyout")}const h="ref=WSB";let u=!0,f,r;t.init=c;t.toggleRewardsFlyout=e;t.EnabledMarketAndRegion=o;t.hideRewardsFlyout=i})(t=n.RewardsFlyoutViewModel||(n.RewardsFlyoutViewModel={}))})(WSB||(WSB={}))